-- Last modification date: 2016-03-26 15:01:22.78




-- tables
-- Table: course
CREATE TABLE course (
    id int  NOT NULL,
    Instructor_id varchar(50)  NOT NULL,
    semester varchar(10)  NOT NULL,
    year int  NOT NULL,
    subject varchar(100)  NOT NULL,
    title varchar(250)  NOT NULL,
    description varchar(1000)  NULL,
    CONSTRAINT course_pk PRIMARY KEY (id)
);



-- Table: favorite
CREATE TABLE favorite (
    id int  NOT NULL,
    user_id varchar(100)  NOT NULL,
    video_id int  NOT NULL,
    CONSTRAINT favorite_pk PRIMARY KEY (id)
);



-- Table: subscription
CREATE TABLE subscription (
    id int  NOT NULL,
    user_id varchar(50)  NOT NULL,
    course_id int  NOT NULL,
    CONSTRAINT subscription_pk PRIMARY KEY (id)
);



-- Table: "user"
CREATE TABLE "user" (
    id varchar(100)  NOT NULL,
    faculty boolean  NOT NULL,
    super_user boolean  NOT NULL,
    CONSTRAINT user_pk PRIMARY KEY (id)
);



-- Table: video
CREATE TABLE video (
    id int  NOT NULL,
    duration decimal(255,2)  NOT NULL,
    date_uploaded date  NOT NULL,
    date_modified date  NOT NULL,
    course_id int  NOT NULL,
    CONSTRAINT video_pk PRIMARY KEY (id)
);







-- foreign keys
-- Reference:  Course_user (table: course)

ALTER TABLE course ADD CONSTRAINT Course_user 
    FOREIGN KEY (Instructor_id)
    REFERENCES "user" (id)
    ON DELETE  SET NULL 
    ON UPDATE  CASCADE 
    NOT DEFERRABLE 
    INITIALLY IMMEDIATE 
;

-- Reference:  favorite_user (table: favorite)

ALTER TABLE favorite ADD CONSTRAINT favorite_user 
    FOREIGN KEY (user_id)
    REFERENCES "user" (id)
    ON DELETE  CASCADE 
    ON UPDATE  CASCADE 
    NOT DEFERRABLE 
    INITIALLY IMMEDIATE 
;

-- Reference:  favorite_video (table: favorite)

ALTER TABLE favorite ADD CONSTRAINT favorite_video 
    FOREIGN KEY (video_id)
    REFERENCES video (id)
    ON DELETE  SET NULL 
    ON UPDATE  CASCADE 
    NOT DEFERRABLE 
    INITIALLY IMMEDIATE 
;

-- Reference:  subscription_Course (table: subscription)

ALTER TABLE subscription ADD CONSTRAINT subscription_Course 
    FOREIGN KEY (course_id)
    REFERENCES course (id)
    ON UPDATE  CASCADE 
    NOT DEFERRABLE 
    INITIALLY IMMEDIATE 
;

-- Reference:  subscription_user (table: subscription)

ALTER TABLE subscription ADD CONSTRAINT subscription_user 
    FOREIGN KEY (user_id)
    REFERENCES "user" (id)
    ON DELETE  CASCADE 
    ON UPDATE  CASCADE 
    NOT DEFERRABLE 
    INITIALLY IMMEDIATE 
;

-- Reference:  video_Course (table: video)

ALTER TABLE video ADD CONSTRAINT video_Course 
    FOREIGN KEY (course_id)
    REFERENCES course (id)
    ON DELETE  SET NULL 
    ON UPDATE  CASCADE 
    NOT DEFERRABLE 
    INITIALLY IMMEDIATE 
;
