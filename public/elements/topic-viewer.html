<link rel="import" href="/bower_components/paper-card/paper-card.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="/bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="/bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="/bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="/bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="/elements/api-elements.html">
<link rel="import" href="/behaviors/api-requestor.html">
<link rel="import" href="/behaviors/cascaded-animation.html">
<link rel="import" href="/styles/shared-styles.html">
<dom-module id="topic-viewer">
	<template>
		<style>
			:host {
				display: block;
				position: relative;
			}
			app-header-layout {
				@apply(--layout-fit);
			}

			#header {
				background: var(--paper-amber-a100);
			}

			.video-card {
				width: 300px;
				height: 250px;
				position: relative;
				text-overflow: ellipsis;
				overflow: hidden;
				margin: 10px;
			}
			



		</style>

		<app-header-layout id=container>

		  <div id="header">
		  	<app-toolbar></app-toolbar>
		    <app-toolbar>
		      <div title>[[topic.title]]</div>
		    </app-toolbar>
		    <app-toolbar></app-toolbar>
		  </div>

		  <template is="dom-repeat" items="[[courses]]">
				<paper-card heading="[[item.person_id]]">
					<div class="card-content">
						<div>
							<span>[[item.semester_id]]</span>
							<span>[[item.year]]</span>
						</div>
					</div>
				</paper-card>	
			</template>


		</app-header-layout>

	</template>
	<script>
		Polymer({
			is: 'topic-viewer',
			behaviors: [Behaviors.api_requestor,  Behaviors.cascaded_animation],
			properties: {
				topicID: {
					type: String,
					value: undefined,
					observer: 'get_new_data'
				},
				topic: {
					type: Object, 
					value: {}
				},
			},

			get_new_data: function (new_topic_id, old_topic_id) {
				this.make_api_request({
					verb: 'GET', 
					resource: ['topics', new_topic_id],
					context: this, 
					callback: function (result) { this.topic = result.body.data; }
				});

				this.make_api_request({
					verb: 'GET',
					resource: 'courses',
					query: { where: { items: {topic_id: new_topic_id}, delimiter: 'AND'}  },
					context: this,
					callback: function (result) { this.courses = result.body.data; }
				});
			},

		});
	</script>
</dom-module>
