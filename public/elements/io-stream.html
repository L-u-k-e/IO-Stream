<!--
	Author: Lucas Parzych
	Email:  parzycl1@sunyit.edu
	Description:
	 This element acts as the top-most mediator. 
	 (Google "mediator pattern" if that term confuses you) 
	
-->





<!-- Third Party Imports-->
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="/bower_components/iron-pages/iron-pages.html">
<link rel="import" href="/bower_components/iron-localstorage/iron-localstorage.html">
<link rel="import" href="/bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="/bower_components/neon-animation/neon-animatable.html">

<link rel="import" href="/bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="/bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="/bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="/bower_components/app-layout/app-scrollpos-control/app-scrollpos-control.html">


<link rel="import" href="/bower_components/paper-styles/paper-styles.html">


<!-- Custom Imports -->
<link rel="import" href="/elements/the-header.html">
<link rel="import" href="/elements/the-sidebar.html">
<link rel="import" href="/elements/loading-overlay.html">
<link rel="import" href="/elements/signin-dialog.html">

<link rel="import" href="/styles/shared-styles.html">
<link rel="import" href="/behaviors/app-router.html">
<link rel="import" href="/behaviors/token-manager.html">

<link rel="import" href="/bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">









<dom-module id="io-stream">


	<template>
	
		<style>
			:host {
				@apply(--layout-fit);
			}
			/* Content needs to be laid out vertically with the header above the rest of the content */
			app-header-layout {
				@apply(--layout-fit);
				@apply(--layout-vertical); 
				background-color: var(--paper-grey-100);
			}

			/* Drawer needs to clear space for the header. */
			 #drawer {
				/* The app-drawer is actually: position:fixed; top:-120px; 
				 * The header is 64px, so we need 184 to clear it. 
				 */
				--app-drawer-content-container: {
					padding-top: 184px;
					@apply(--shadow-elevation-3dp);
				};
			}

			#pages,
			#pages > * {
				@apply(--layout-fit);
			}

		</style>

		<app-scrollpos-control selected="{{page}}"></app-scrollpos-control>

		<signin-dialog id="signin_dialog"></signin-dialog>

		<app-header-layout has-scrolling-region>

			<app-header fixed shadow>
				<the-header></the-header>
			</app-header>

			<app-drawer-layout fullbleed responsive-width="1250px">
				<loading-overlay id="loading_overlay" active="[[loading]]"></loading-overlay>
				<app-drawer id="drawer">
					 <the-sidebar selected="[[page]]"></the-sidebar>
				</app-drawer>
				<iron-pages id="pages" selected="[[page]]" attr-for-selected="data-page" selected-attribute="showing">
					<signin-page    id="welcome"        data-page="welcome"></signin-page>
					<topic-browser  id="topic_browser"  data-page="topic browser"></topic-browser>
					<topic-viewer   id="topic_viewer"   data-page="topic viewer"></topic-viewer>
					<course-viewer  id="course_viewer"  data-page="course viewer"></course-viewer>
					<video-viewer   id="video_viewer"   data-page="video viewer"></video-viewer>
					<file-uploader  id="video_browser"  data-page="watch"></file-uploader>
					<course-creator id="course-creator" data-page="course creator"></course-creator>
				</iron-pages>			
			</app-drawer-layout>

		</app-header-layout>



	</template>






	<script>
		Polymer({
			is: 'io-stream',

			behaviors: [Behaviors.app_router, Behaviors.token_manager],

			listeners: {
				'drawer-toggle-request': '_toggle_drawer',
				'signin-request': '_toggle_signin_dialog'
			},

			ready: function () {
				this.load_token();
			},

			_toggle_drawer: function (event, detail) {
				this.$.drawer.toggle();
			},

			_toggle_signin_dialog: function(event, detail) {
				this.$.signin_dialog.open({success_callback: detail.success_callback});
			},

		});
	</script>


</dom-module>