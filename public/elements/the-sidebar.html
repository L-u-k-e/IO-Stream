<!--
	Author: Lucas Parzych
	Email:  parzycl1@sunyit.edu
	Description:
		This is the sidebar.
		Communication with the mediator is done via data binding.
	 
		The data binding is two way, so this element is responsible for both informing the mediator 
		when the selected menu item changes and also for changing the selected menu item when the 
		mediator deems appropriate. 
-->





<!-- Third Party Imports -->
<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/paper-menu/paper-menu.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/iron-icons/av-icons.html">

<!-- Custom Imports -->
<link rel="import" href="/styles/shared-styles.html">
<link rel="import" href="/behaviors/token-manager.html">











<dom-module id="the-sidebar">


	<template>

		<style>
			:host {
				display: block;
			}


			paper-item {
				--paper-item-focused: {
					color: var(--primary-color);
				};
				cursor: pointer;
			}

			paper-item span {
				transition: 0.3s ease;
			}

			paper-item iron-icon {
				margin-right: 20px;
				color: #444;
			}
		</style>


		<paper-menu id="menu" selected="[[selected]]" attr-for-selected="data-page" on-iron-activate="_navigate">

			<template is="dom-repeat" items="[[_public_menu_items]]">
				<paper-item data-page="[[item.page]]">
					<iron-icon icon="[[item.icon]]"></iron-icon>
					<span>[[item.text]]</span>
				</paper-item>
			</template>

			<template is="dom-if" if="[[token.decoded.user.faculty]]">
				<template is="dom-repeat" items="[[_faculty_menu_items]]">
					<paper-item data-page="[[item.page]]">
						<iron-icon icon="[[item.icon]]"></iron-icon>
						<span>[[item.text]]</span>
					</paper-item>
				</template>
			</template>

			<template is="dom-if" if="[[token.decoded.user.super_user]]">
				<template is="dom-repeat" items="[[_admin_menu_items]]">
					<paper-item data-page="[[item.page]]">
						<iron-icon icon="[[item.icon]]"></iron-icon>
						<span>[[item.text]]</span>
					</paper-item>
				</template>
			</template>

		</paper-menu>

	</template>






	<script>
		Polymer({
			is: 'the-sidebar',

			behaviors: [Behaviors.token_manager],

			properties: {
				selected: {
					type: 'string',
					value: '',
				},
			},

			ready: function () {
				this._public_menu_items = [
					{icon: 'explore'           , text: 'View All Topics'      , page: 'topics' },
					{icon: 'track-changes'     , text: 'Subscriptions'        , page: 'topics' },
					{icon: 'star'              , text: 'Favorites'            , page: 'topics' },
					{icon: 'av:fiber-new'      , text: 'New Videos'           , page: 'watch'  }
				];

				this._faculty_menu_items = [
					{icon: 'record-voice-over', text: 'My Courses', page: 'watch'}
				];

				this._admin_menu_items = [
					{icon: 'view-module', text: 'Edit Topics', page: 'watch'}
				];

			},


			_navigate: function (event, detail) {
				var url = '/' + detail.selected;
				this.fire('navigation-request', {url: url});
			}


		});
	</script>


</dom-module>