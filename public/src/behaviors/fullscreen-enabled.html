<script>

  var Behaviors = Behaviors || {};

  Behaviors.fullscreen_enabled = (function () {

    var temp_div = document.createElement('div');
    var enter_methods = ['requestFullscreen', 'mozRequestFullScreen', 'webkitRequestFullScreen', 'msRequestFullscreen'];
    var enter = _.find(enter_methods, function(prop) { return temp_div[prop] });

    var exit_methods  = ['exitFullscreen',    'mozCancelFullScreen',  'webkitCancelFullScreen',  'msExitFullscreen'   ]; 
    var exit = _.find(exit_methods, function(prop) { return document[prop] });

    var reflect_state = function (fullscreen_desired) {
      var target = this.hasOwnProperty('_fullscreen_target') ? this._fullscreen_target : this;
      this.toggleAttribute('data-fullscreen', fullscreen_desired, target);
      if (fullscreen_desired) { target[enter](); }
      else { document[exit](); }
    };


    var fullscreen_state_variable_changed = function (new_value, old_value) {
      reflect_state.call(this, new_value);
      if (this.hasOwnProperty('_fullscreen_changed')) {
        this._fullscreen_changed(new_value, old_value);  
      }
    };


    return Object.freeze({
      properties: {
        fullscreen: {
          type: Boolean,
          value: false,
          observer: '__fullscreen_state_variable_changed___'
        },
      },
      __fullscreen_state_variable_changed___: fullscreen_state_variable_changed
    });
  }());
</script>